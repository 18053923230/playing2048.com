# 2048 游戏平台技术实现方案

## 1. 项目初始化

### 1.1 创建 Next.js 项目

```bash
npx create-next-app@latest playing2048 --typescript --tailwind --eslint --app --src-dir --import-alias "@/*"
cd playing2048
```

### 1.2 安装依赖

```bash
pnpm add @heroicons/react
pnpm add -D @types/node
```

### 1.3 配置 shadcn/ui

```bash
npx shadcn@latest init
npx shadcn@latest add button card input select
```

## 2. 项目结构设计

```
src/
├── app/
│   ├── layout.tsx                 # 根布局
│   ├── page.tsx                   # 首页
│   ├── cupcakes/
│   │   └── page.tsx              # Cupcakes游戏页
│   ├── christmas/
│   │   └── page.tsx              # 圣诞主题页
│   ├── halloween/
│   │   └── page.tsx              # 万圣节主题页
│   ├── unblocked/
│   │   └── page.tsx              # 无限制版本页
│   ├── strategy/
│   │   └── page.tsx              # 攻略页面
│   ├── how-to-play/
│   │   └── page.tsx              # 游戏教程页
│   └── globals.css               # 全局样式
├── components/
│   ├── game/
│   │   ├── GameBoard.tsx         # 游戏棋盘
│   │   ├── GameControls.tsx      # 游戏控制
│   │   ├── GameStats.tsx         # 游戏统计
│   │   ├── GameTile.tsx          # 游戏方块
│   │   └── GameOverlay.tsx       # 游戏覆盖层
│   ├── ui/                       # shadcn/ui组件
│   ├── seo/
│   │   └── SEOHead.tsx           # SEO头部组件
│   └── layout/
│       ├── Header.tsx            # 页面头部
│       ├── Footer.tsx            # 页面底部
│       └── Navigation.tsx        # 导航组件
├── lib/
│   ├── game/
│   │   ├── gameLogic.ts          # 游戏核心逻辑
│   │   ├── gameState.ts          # 游戏状态管理
│   │   └── gameThemes.ts         # 游戏主题配置
│   ├── storage/
│   │   └── localStorage.ts       # 本地存储管理
│   ├── seo/
│   │   └── seoConfig.ts          # SEO配置
│   └── utils/
│       └── helpers.ts            # 工具函数
├── types/
│   └── game.ts                   # 游戏类型定义
└── styles/
    └── themes.css                # 主题样式
```

## 3. 核心类型定义

### 3.1 游戏类型定义 (types/game.ts)

```typescript
export type Direction = "up" | "down" | "left" | "right";
export type GameTheme = "cupcakes" | "christmas" | "halloween" | "classic";
export type GameStatus = "playing" | "won" | "lost" | "paused";

export interface GameTile {
  id: string;
  value: number;
  position: [number, number];
  mergedFrom?: string[];
  isNew?: boolean;
}

export interface GameState {
  board: GameTile[][];
  score: number;
  bestScore: number;
  status: GameStatus;
  theme: GameTheme;
  moves: number;
  startTime: number;
  lastMoveTime: number;
}

export interface GameConfig {
  size: number;
  targetValue: number;
  theme: GameTheme;
  difficulty: "easy" | "medium" | "hard";
}

export interface ThemeConfig {
  name: string;
  colors: {
    background: string;
    tile: string;
    text: string;
    accent: string;
  };
  tiles: Record<
    number,
    {
      label: string;
      color: string;
      emoji?: string;
    }
  >;
}
```

## 4. 游戏核心逻辑

### 4.1 游戏逻辑实现 (lib/game/gameLogic.ts)

```typescript
import { GameState, GameTile, Direction, GameConfig } from "@/types/game";

export class Game2048 {
  private state: GameState;
  private config: GameConfig;

  constructor(config: GameConfig) {
    this.config = config;
    this.state = this.createInitialState();
  }

  private createInitialState(): GameState {
    const board = Array(this.config.size)
      .fill(null)
      .map(() => Array(this.config.size).fill(null));

    return {
      board,
      score: 0,
      bestScore: this.loadBestScore(),
      status: "playing",
      theme: this.config.theme,
      moves: 0,
      startTime: Date.now(),
      lastMoveTime: Date.now(),
    };
  }

  public move(direction: Direction): boolean {
    if (this.state.status !== "playing") return false;

    const oldBoard = JSON.stringify(this.state.board);
    const moved = this.performMove(direction);

    if (moved) {
      this.addRandomTile();
      this.state.moves++;
      this.state.lastMoveTime = Date.now();
      this.checkGameStatus();
      this.saveGame();
    }

    return moved;
  }

  private performMove(direction: Direction): boolean {
    let moved = false;
    const size = this.config.size;

    switch (direction) {
      case "left":
        moved = this.moveLeft();
        break;
      case "right":
        moved = this.moveRight();
        break;
      case "up":
        moved = this.moveUp();
        break;
      case "down":
        moved = this.moveDown();
        break;
    }

    return moved;
  }

  private moveLeft(): boolean {
    let moved = false;
    const size = this.config.size;

    for (let row = 0; row < size; row++) {
      const line = this.state.board[row].filter((tile) => tile !== null);
      const merged = this.mergeLine(line);

      if (merged.length !== this.state.board[row].length) {
        moved = true;
      }

      // 填充空位
      while (merged.length < size) {
        merged.push(null);
      }

      this.state.board[row] = merged;
    }

    return moved;
  }

  private moveRight(): boolean {
    this.rotateBoard(2);
    const moved = this.moveLeft();
    this.rotateBoard(2);
    return moved;
  }

  private moveUp(): boolean {
    this.rotateBoard(3);
    const moved = this.moveLeft();
    this.rotateBoard(1);
    return moved;
  }

  private moveDown(): boolean {
    this.rotateBoard(1);
    const moved = this.moveLeft();
    this.rotateBoard(3);
    return moved;
  }

  private mergeLine(line: GameTile[]): GameTile[] {
    const merged: GameTile[] = [];

    for (let i = 0; i < line.length; i++) {
      if (line[i] === null) continue;

      if (
        i + 1 < line.length &&
        line[i + 1] !== null &&
        line[i]!.value === line[i + 1]!.value
      ) {
        // 合并相同值的方块
        const mergedTile: GameTile = {
          id: `${Date.now()}-${Math.random()}`,
          value: line[i]!.value * 2,
          position: line[i]!.position,
          mergedFrom: [line[i]!.id, line[i + 1]!.id],
        };
        merged.push(mergedTile);
        this.state.score += mergedTile.value;
        i++; // 跳过下一个方块
      } else {
        merged.push(line[i]!);
      }
    }

    return merged;
  }

  private rotateBoard(times: number): void {
    const size = this.config.size;
    for (let t = 0; t < times; t++) {
      const rotated = Array(size)
        .fill(null)
        .map(() => Array(size).fill(null));

      for (let i = 0; i < size; i++) {
        for (let j = 0; j < size; j++) {
          rotated[j][size - 1 - i] = this.state.board[i][j];
        }
      }

      this.state.board = rotated;
    }
  }

  private addRandomTile(): void {
    const emptyCells = this.getEmptyCells();
    if (emptyCells.length === 0) return;

    const [row, col] =
      emptyCells[Math.floor(Math.random() * emptyCells.length)];
    const value = Math.random() < 0.9 ? 2 : 4;

    const newTile: GameTile = {
      id: `${Date.now()}-${Math.random()}`,
      value,
      position: [row, col],
      isNew: true,
    };

    this.state.board[row][col] = newTile;
  }

  private getEmptyCells(): [number, number][] {
    const empty: [number, number][] = [];
    const size = this.config.size;

    for (let i = 0; i < size; i++) {
      for (let j = 0; j < size; j++) {
        if (this.state.board[i][j] === null) {
          empty.push([i, j]);
        }
      }
    }

    return empty;
  }

  private checkGameStatus(): void {
    // 检查是否获胜
    if (this.hasWinningTile()) {
      this.state.status = "won";
      return;
    }

    // 检查是否失败
    if (!this.canMove()) {
      this.state.status = "lost";
      return;
    }
  }

  private hasWinningTile(): boolean {
    const size = this.config.size;
    for (let i = 0; i < size; i++) {
      for (let j = 0; j < size; j++) {
        if (
          this.state.board[i][j] &&
          this.state.board[i][j]!.value >= this.config.targetValue
        ) {
          return true;
        }
      }
    }
    return false;
  }

  private canMove(): boolean {
    // 检查是否有空位
    if (this.getEmptyCells().length > 0) return true;

    // 检查是否可以合并
    const size = this.config.size;
    for (let i = 0; i < size; i++) {
      for (let j = 0; j < size; j++) {
        const current = this.state.board[i][j];
        if (!current) continue;

        // 检查右边
        if (
          j + 1 < size &&
          this.state.board[i][j + 1] &&
          current.value === this.state.board[i][j + 1]!.value
        ) {
          return true;
        }

        // 检查下边
        if (
          i + 1 < size &&
          this.state.board[i + 1][j] &&
          current.value === this.state.board[i + 1][j]!.value
        ) {
          return true;
        }
      }
    }

    return false;
  }

  public getState(): GameState {
    return { ...this.state };
  }

  public newGame(): void {
    this.state = this.createInitialState();
    this.addRandomTile();
    this.addRandomTile();
    this.saveGame();
  }

  public resetGame(): void {
    this.state.score = 0;
    this.state.moves = 0;
    this.state.status = "playing";
    this.state.startTime = Date.now();
    this.newGame();
  }

  private loadBestScore(): number {
    if (typeof window === "undefined") return 0;
    return parseInt(localStorage.getItem("2048-best-score") || "0");
  }

  private saveGame(): void {
    if (typeof window === "undefined") return;

    localStorage.setItem("2048-game-state", JSON.stringify(this.state));

    if (this.state.score > this.state.bestScore) {
      this.state.bestScore = this.state.score;
      localStorage.setItem("2048-best-score", this.state.bestScore.toString());
    }
  }

  public loadGame(): void {
    if (typeof window === "undefined") return;

    const saved = localStorage.getItem("2048-game-state");
    if (saved) {
      try {
        const loadedState = JSON.parse(saved);
        this.state = { ...this.state, ...loadedState };
      } catch (error) {
        console.error("Failed to load game state:", error);
      }
    }
  }
}
```

## 5. 游戏主题配置

### 5.1 主题配置 (lib/game/gameThemes.ts)

```typescript
import { ThemeConfig } from "@/types/game";

export const gameThemes: Record<string, ThemeConfig> = {
  cupcakes: {
    name: "Cupcakes",
    colors: {
      background: "#fdf6e3",
      tile: "#f0e68c",
      text: "#2f4f4f",
      accent: "#ff69b4",
    },
    tiles: {
      2: { label: "Vanilla", color: "#f0e68c", emoji: "🧁" },
      4: { label: "Chocolate", color: "#8b4513", emoji: "🍫" },
      8: { label: "Strawberry", color: "#ff69b4", emoji: "🍓" },
      16: { label: "Blueberry", color: "#4169e1", emoji: "🫐" },
      32: { label: "Lemon", color: "#ffff00", emoji: "🍋" },
      64: { label: "Orange", color: "#ffa500", emoji: "🍊" },
      128: { label: "Mint", color: "#98fb98", emoji: "🌿" },
      256: { label: "Caramel", color: "#d2691e", emoji: "🍯" },
      512: { label: "Raspberry", color: "#dc143c", emoji: "🍒" },
      1024: { label: "Rainbow", color: "#ff1493", emoji: "🌈" },
      2048: { label: "Golden", color: "#ffd700", emoji: "👑" },
      4096: { label: "Diamond", color: "#00ffff", emoji: "💎" },
    },
  },
  christmas: {
    name: "Christmas",
    colors: {
      background: "#f0f8ff",
      tile: "#90ee90",
      text: "#2f4f4f",
      accent: "#ff0000",
    },
    tiles: {
      2: { label: "Snowflake", color: "#ffffff", emoji: "❄️" },
      4: { label: "Candy Cane", color: "#ff0000", emoji: "🍭" },
      8: { label: "Holly", color: "#228b22", emoji: "🎄" },
      16: { label: "Gift", color: "#ff69b4", emoji: "🎁" },
      32: { label: "Star", color: "#ffd700", emoji: "⭐" },
      64: { label: "Bell", color: "#ffa500", emoji: "🔔" },
      128: { label: "Santa", color: "#ff0000", emoji: "🎅" },
      256: { label: "Reindeer", color: "#8b4513", emoji: "🦌" },
      512: { label: "Elf", color: "#228b22", emoji: "🧝" },
      1024: { label: "Angel", color: "#ffffff", emoji: "👼" },
      2048: { label: "Christmas Tree", color: "#228b22", emoji: "🎄" },
      4096: { label: "North Pole", color: "#00ffff", emoji: "🧭" },
    },
  },
  halloween: {
    name: "Halloween",
    colors: {
      background: "#2f2f2f",
      tile: "#8b4513",
      text: "#ffffff",
      accent: "#ff8c00",
    },
    tiles: {
      2: { label: "Pumpkin", color: "#ff8c00", emoji: "🎃" },
      4: { label: "Ghost", color: "#ffffff", emoji: "👻" },
      8: { label: "Bat", color: "#2f2f2f", emoji: "🦇" },
      16: { label: "Spider", color: "#8b0000", emoji: "🕷️" },
      32: { label: "Witch", color: "#800080", emoji: "🧙‍♀️" },
      64: { label: "Skeleton", color: "#f5f5dc", emoji: "💀" },
      128: { label: "Vampire", color: "#8b0000", emoji: "🧛" },
      256: { label: "Werewolf", color: "#696969", emoji: "🐺" },
      512: { label: "Zombie", color: "#228b22", emoji: "🧟" },
      1024: { label: "Mummy", color: "#f5f5dc", emoji: "👻" },
      2048: { label: "Frankenstein", color: "#228b22", emoji: "🧟‍♂️" },
      4096: { label: "Dracula", color: "#8b0000", emoji: "🧛‍♂️" },
    },
  },
};
```

## 6. 游戏组件实现

### 6.1 游戏棋盘组件 (components/game/GameBoard.tsx)

```typescript
"use client";

import React, { useEffect, useRef } from "react";
import { GameTile } from "@/types/game";
import { GameTileComponent } from "./GameTile";

interface GameBoardProps {
  board: GameTile[][];
  theme: string;
  onTileClick?: (tile: GameTile) => void;
}

export const GameBoard: React.FC<GameBoardProps> = ({
  board,
  theme,
  onTileClick,
}) => {
  const boardRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      // 键盘事件处理将在GameControls中实现
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, []);

  return (
    <div className="relative bg-gray-200 rounded-lg p-4 shadow-lg">
      <div
        ref={boardRef}
        className="grid grid-cols-4 gap-2 w-80 h-80 bg-gray-300 rounded-lg p-2"
      >
        {board.map((row, rowIndex) =>
          row.map((tile, colIndex) => (
            <div
              key={`${rowIndex}-${colIndex}`}
              className="w-full h-full bg-gray-100 rounded-lg flex items-center justify-center"
            >
              {tile && (
                <GameTileComponent
                  tile={tile}
                  theme={theme}
                  onClick={() => onTileClick?.(tile)}
                />
              )}
            </div>
          ))
        )}
      </div>
    </div>
  );
};
```

### 6.2 游戏方块组件 (components/game/GameTile.tsx)

```typescript
"use client";

import React from "react";
import { GameTile } from "@/types/game";
import { gameThemes } from "@/lib/game/gameThemes";

interface GameTileComponentProps {
  tile: GameTile;
  theme: string;
  onClick?: () => void;
}

export const GameTileComponent: React.FC<GameTileComponentProps> = ({
  tile,
  theme,
  onClick,
}) => {
  const themeConfig = gameThemes[theme];
  const tileConfig =
    themeConfig.tiles[tile.value as keyof typeof themeConfig.tiles];

  return (
    <div
      className={`
        w-full h-full rounded-lg flex items-center justify-center
        transition-all duration-200 ease-in-out
        ${tile.isNew ? "animate-pulse" : ""}
        ${tile.mergedFrom ? "animate-bounce" : ""}
        cursor-pointer hover:scale-105
      `}
      style={{
        backgroundColor: tileConfig?.color || "#ccc",
        color: themeConfig.colors.text,
      }}
      onClick={onClick}
    >
      <div className="text-center">
        <div className="text-2xl font-bold">
          {tileConfig?.emoji || tile.value}
        </div>
        <div className="text-xs font-medium">
          {tileConfig?.label || tile.value}
        </div>
      </div>
    </div>
  );
};
```

## 7. SEO 优化实现

### 7.1 SEO 头部组件 (components/seo/SEOHead.tsx)

```typescript
import Head from "next/head";

interface SEOHeadProps {
  title: string;
  description: string;
  keywords: string;
  ogImage?: string;
  canonical?: string;
}

export const SEOHead: React.FC<SEOHeadProps> = ({
  title,
  description,
  keywords,
  ogImage = "/og-image.jpg",
  canonical,
}) => {
  return (
    <Head>
      <title>{title}</title>
      <meta name="description" content={description} />
      <meta name="keywords" content={keywords} />
      <meta name="robots" content="index, follow" />

      {/* Open Graph */}
      <meta property="og:title" content={title} />
      <meta property="og:description" content={description} />
      <meta property="og:image" content={ogImage} />
      <meta property="og:type" content="website" />
      <meta property="og:site_name" content="Playing2048.com" />

      {/* Twitter Card */}
      <meta name="twitter:card" content="summary_large_image" />
      <meta name="twitter:title" content={title} />
      <meta name="twitter:description" content={description} />
      <meta name="twitter:image" content={ogImage} />

      {/* Canonical URL */}
      {canonical && <link rel="canonical" href={canonical} />}

      {/* Additional meta tags */}
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <meta name="theme-color" content="#3b82f6" />
    </Head>
  );
};
```

### 7.2 SEO 配置 (lib/seo/seoConfig.ts)

```typescript
export const seoConfig = {
  home: {
    title: "Play 2048 Cupcakes Online - Free Puzzle Game | Playing2048.com",
    description:
      "Play 2048 Cupcakes online for free! Join numbers and get to the winning tile. Customize your base number and difficulty for endless fun. No download required.",
    keywords:
      "2048 cupcakes, play 2048 cupcakes, 2048 cupcakes online, free 2048 game, puzzle game",
    canonical: "https://playing2048.com",
  },
  cupcakes: {
    title: "2048 Cupcakes - Play Online Free | The Most Delicious 2048 Game",
    description:
      "Play 2048 Cupcakes online for free! The most delicious version of the classic 2048 puzzle game. Merge cupcakes to reach the golden cupcake!",
    keywords:
      "2048 cupcakes, 2048 cupcakes unblocked, play 2048 cupcakes online, cupcake puzzle game",
    canonical: "https://playing2048.com/cupcakes",
  },
  christmas: {
    title: "2048 Cupcakes Christmas Edition - Holiday Puzzle Game",
    description:
      "Celebrate the holidays with 2048 Cupcakes Christmas Edition! Festive puzzle game with holiday-themed cupcakes and Christmas magic.",
    keywords:
      "2048 cupcakes christmas, christmas 2048, holiday puzzle game, christmas cupcakes game",
    canonical: "https://playing2048.com/christmas",
  },
  halloween: {
    title: "2048 Cupcakes Halloween Edition - Spooky Puzzle Game",
    description:
      "Get spooky with 2048 Cupcakes Halloween Edition! Merge Halloween-themed cupcakes in this thrilling puzzle game.",
    keywords:
      "2048 cupcakes halloween, halloween 2048, spooky puzzle game, halloween cupcakes",
    canonical: "https://playing2048.com/halloween",
  },
  unblocked: {
    title: "2048 Cupcakes Unblocked - Play at School or Work",
    description:
      "Play 2048 Cupcakes unblocked! Access the game from anywhere - school, work, or home. No restrictions, just pure puzzle fun.",
    keywords:
      "2048 cupcakes unblocked, unblocked 2048, play 2048 at school, work games",
    canonical: "https://playing2048.com/unblocked",
  },
  strategy: {
    title: "How to Win 2048 Cupcakes - Complete Strategy Guide",
    description:
      "Learn how to win 2048 Cupcakes with our complete strategy guide. Master the game with proven tips and tricks.",
    keywords:
      "how to win 2048 cupcakes, 2048 cupcakes strategy, 2048 tips and tricks, cupcake game guide",
    canonical: "https://playing2048.com/strategy",
  },
};
```

## 8. 页面实现示例

### 8.1 首页实现 (app/page.tsx)

```typescript
import { SEOHead } from "@/components/seo/SEOHead";
import { seoConfig } from "@/lib/seo/seoConfig";
import Link from "next/link";

export default function HomePage() {
  return (
    <>
      <SEOHead {...seoConfig.home} />

      <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
        <div className="container mx-auto px-4 py-8">
          <header className="text-center mb-12">
            <h1 className="text-6xl font-bold mb-4">
              <span className="text-red-500">20</span>
              <span className="text-teal-500">48</span>
            </h1>
            <p className="text-xl text-gray-600 max-w-2xl mx-auto">
              Join numbers and get to the winning tile! Customize your base
              number and difficulty for endless fun.
            </p>
          </header>

          <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
            <Link href="/cupcakes" className="group">
              <div className="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow">
                <div className="text-4xl mb-4">🧁</div>
                <h2 className="text-2xl font-bold mb-2">Cupcakes</h2>
                <p className="text-gray-600">
                  The most delicious version of 2048
                </p>
              </div>
            </Link>

            <Link href="/christmas" className="group">
              <div className="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow">
                <div className="text-4xl mb-4">🎄</div>
                <h2 className="text-2xl font-bold mb-2">Christmas</h2>
                <p className="text-gray-600">Holiday-themed puzzle fun</p>
              </div>
            </Link>

            <Link href="/halloween" className="group">
              <div className="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow">
                <div className="text-4xl mb-4">🎃</div>
                <h2 className="text-2xl font-bold mb-2">Halloween</h2>
                <p className="text-gray-600">Spooky puzzle adventure</p>
              </div>
            </Link>
          </div>

          <div className="text-center mt-12">
            <Link
              href="/strategy"
              className="inline-block bg-teal-500 text-white px-8 py-3 rounded-lg hover:bg-teal-600 transition-colors"
            >
              Learn How to Play
            </Link>
          </div>
        </div>
      </div>
    </>
  );
}
```

### 8.2 Cupcakes 游戏页 (app/cupcakes/page.tsx)

```typescript
"use client";

import { useEffect, useState } from "react";
import { SEOHead } from "@/components/seo/SEOHead";
import { GameBoard } from "@/components/game/GameBoard";
import { GameControls } from "@/components/game/GameControls";
import { GameStats } from "@/components/game/GameStats";
import { Game2048 } from "@/lib/game/gameLogic";
import { seoConfig } from "@/lib/seo/seoConfig";

export default function CupcakesPage() {
  const [game, setGame] = useState<Game2048 | null>(null);
  const [gameState, setGameState] = useState<any>(null);

  useEffect(() => {
    const newGame = new Game2048({
      size: 4,
      targetValue: 4096,
      theme: "cupcakes",
      difficulty: "medium",
    });

    newGame.loadGame();
    setGame(newGame);
    setGameState(newGame.getState());
  }, []);

  const handleMove = (direction: string) => {
    if (!game) return;

    const moved = game.move(direction as any);
    if (moved) {
      setGameState(game.getState());
    }
  };

  const handleNewGame = () => {
    if (!game) return;

    game.newGame();
    setGameState(game.getState());
  };

  const handleReset = () => {
    if (!game) return;

    game.resetGame();
    setGameState(game.getState());
  };

  if (!gameState) {
    return <div>Loading...</div>;
  }

  return (
    <>
      <SEOHead {...seoConfig.cupcakes} />

      <div className="min-h-screen bg-gradient-to-br from-pink-50 to-purple-100">
        <div className="container mx-auto px-4 py-8">
          <div className="max-w-4xl mx-auto">
            <header className="text-center mb-8">
              <h1 className="text-4xl font-bold mb-2">2048 Cupcakes</h1>
              <p className="text-gray-600">
                Merge cupcakes to reach the golden cupcake!
              </p>
            </header>

            <div className="grid md:grid-cols-3 gap-8">
              {/* 游戏控制面板 */}
              <div className="md:col-span-1">
                <GameStats
                  score={gameState.score}
                  bestScore={gameState.bestScore}
                  moves={gameState.moves}
                />
                <GameControls
                  onNewGame={handleNewGame}
                  onReset={handleReset}
                  onMove={handleMove}
                />
              </div>

              {/* 游戏棋盘 */}
              <div className="md:col-span-2 flex justify-center">
                <GameBoard board={gameState.board} theme="cupcakes" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </>
  );
}
```

## 9. 部署配置

### 9.1 Vercel 配置 (vercel.json)

```json
{
  "buildCommand": "pnpm build",
  "outputDirectory": ".next",
  "framework": "nextjs",
  "installCommand": "pnpm install",
  "devCommand": "pnpm dev",
  "regions": ["iad1"],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "X-Content-Type-Options",
          "value": "nosniff"
        },
        {
          "key": "X-Frame-Options",
          "value": "DENY"
        },
        {
          "key": "X-XSS-Protection",
          "value": "1; mode=block"
        }
      ]
    }
  ]
}
```

### 9.2 环境变量配置 (.env.local)

```bash
NEXT_PUBLIC_SITE_URL=https://playing2048.com
NEXT_PUBLIC_GOOGLE_ANALYTICS_ID=GA_MEASUREMENT_ID
NEXT_PUBLIC_GOOGLE_ADSENSE_ID=ca-pub-XXXXXXXXXX
```

## 10. 下一步行动计划

### 第 1 周任务清单：

- [ ] 初始化 Next.js 项目
- [ ] 配置 TypeScript 和 Tailwind CSS
- [ ] 集成 shadcn/ui 组件库
- [ ] 实现基础游戏逻辑
- [ ] 创建首页和 Cupcakes 游戏页
- [ ] 设置基础 SEO 优化

### 第 2 周任务清单：

- [ ] 完善游戏功能
- [ ] 添加主题系统
- [ ] 实现本地存储
- [ ] 优化移动端体验
- [ ] 添加游戏音效和动画

### 第 3 周任务清单：

- [ ] 创建其他主题页面
- [ ] 实现攻略和教程页面
- [ ] 优化 SEO 和性能
- [ ] 测试和调试
- [ ] 准备部署

### 第 4 周任务清单：

- [ ] 部署到 Vercel
- [ ] 设置域名和 SSL
- [ ] 配置 Google Analytics
- [ ] 提交 sitemap 到 Google
- [ ] 开始基础推广

这个技术实现方案提供了完整的开发路线图，确保项目能够按照计划顺利实施。
